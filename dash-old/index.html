<!DOCTYPE html><html><head><meta http-equiv="Content-type" content="text/html;charset=UTF-8"><base href=".."><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1"><!-- Global site tag (gtag.js) - Google Analytics--><script async src="https://www.googletagmanager.com/gtag/js?id=G-HXVX4JRNGZ"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-HXVX4JRNGZ');</script><link rel="stylesheet" type="text/css" href="/assets/lib/bootstrap/main/dist/css/bootstrap.min.css"><link rel="stylesheet" type="text/css" href="/assets/lib/@loadingio/bootstrap.ext/main/index.min.css"><link rel="stylesheet" type="text/css" href="/assets/lib/ldiconfont/main/index.min.css"><link rel="stylesheet" type="text/css" href="/assets/lib/ldslider/main/index.min.css"><link rel="stylesheet" type="text/css" href="/assets/lib/ldcover/main/index.min.css"><link rel="stylesheet" type="text/css" href="/assets/lib/ldloader/main/index.min.css"><link rel="stylesheet" type="text/css" href="/assets/lib/ldbutton/main/index.min.css"><link rel="stylesheet" type="text/css" href="/assets/lib/ldpalettepicker/main/index.min.css"><link rel="stylesheet" type="text/css" href="/assets/lib/@loadingio/loading.css/main/lite.min.css"><link rel="stylesheet" type="text/css" href="/assets/lib/@loadingio/transition.css/main/transition.min.css"><link rel="stylesheet" type="text/css" href="/assets/lib/@loadingio/ldcolorpicker/main/index.min.css"><link rel="stylesheet" type="text/css" href="/assets/lib/@plotdb/sheet/main/index.min.css"><link rel="stylesheet" type="text/css" href="/assets/lib/@plotdb/chart/main/index.min.css"><link rel="stylesheet" type="text/css" href="css/panel.css"><link rel="stylesheet" type="text/css" href="css/index.css"><title>主題產業數據儀表板</title><style type="text/css">.header{display:flex;align-items:center}.header .entry{opacity:.5;cursor:pointer}.header .entry.active{opacity:1;color:#fff}#root{height:100%;font-size:14px}.dashboard{position:absolute;top:0;left:0;z-index:10;display:grid;padding:1em;gap:1em;width:100%;height:100%;perspective:1000px}.pnl.widget{padding-top:.5em;opacity:1;transform:rotate3d(0,1,0,0);transition:transform .35s ease-in-out,opacity .35s ease-in-out;z-index:1;position:relative}.pnl.widget.highlight{color:#f5faff}.pnl.widget.highlight.color{text-shadow:0 1px 1px rgba(0,0,0,0.3)}.pnl.widget.highlight.color-film{background:#b53d27}.pnl.widget.highlight.color-revenue{background:#dfa921}.pnl.widget.highlight.color-ticket{background:#31df46}.pnl.inactive{z-index:0;opacity:0}.dashboard.hide{z-index:1;pointer-events:none}.dashboard.hide .pnl.widget{transform:rotate3d(0,1,0,360deg);opacity:0}.dashboard.hide[data-name=tw] .pnl.widget{transform:rotate3d(0,1,0,-360deg)}.rank-list-item{border:1px solid transparent;border-radius:.25em;margin:0 0 .5em;transition:all .15s ease-in-out}.rank-list-item:hover{margin:-0.25em 0 .75em;box-shadow:0 3px 3px 1px rgba(0,0,0,0.2)}.hint{display:inline-block;font-size:12px;color:#fff}[data-name=title]{grid-column:1/-1;grid-row:1}@media(max-width:1200px){body{font-size:14px}}@media(max-width:1024px){body{overflow:scroll}.dashboard{position:static;grid-template-columns:1fr !important;grid-template-rows:auto}.dashboard .pnl{grid-area:auto !important;height:75vw}.header .unclickable{display:none}#root{height:auto}.dashboard.hide{display:none}}@media(max-width:800px){.header{flex-direction:column;text-align:center}.header>div{margin-bottom:.5em}}</style></head><body><div class="ldcv scroll text-dark" ld="ldcv" data-name="rank"><div class="base w-1024"><div class="inner card"><div class="card-body"><h3>電影票房總排名</h3><p>指定時間範圍內，國內外電影依總票房排名結果</p><hr><div class="mb-2 d-flex align-items-center justify-content-start"><div class="px-2 py-1 mr-2 text-right rounded" style="width:3em">排名</div><div class="px-2 py-1 mr-2 text-center rounded" style="width:6em">國別</div><div class="px-2 py-1 mr-2 text-center" style="width:8em">總票房 <small>(新臺幣)</small></div><div class="px-2 py-1 flex-grow-1">片名</div></div><div class="d-flex align-items-center justify-content-start rank-list-item py-1 px-1" ld-each="rank"><div class="px-2 py-1 mr-2 text-right bg-white" ld="rank" style="width:3em"></div><div class="px-2 py-1 text-white mr-2 text-center rounded" ld="country" style="width:6em"></div><div class="px-2 py-1 mr-2 text-right bg-light" style="width:8em"><span ld="revenue"></span><span>元</span></div><div class="px-2 py-1 bg-light flex-grow-1" ld="name"></div></div></div></div></div></div><div class="ldcv scroll" ld="ldcv" data-name="detail"><div class="base w-1024" style="height:80%;min-height:90%;"><div class="inner card"><div class="card-body p-0"><div class="p-2 d-flex"><div class="flex-grow-1"><input class="form-control form-control-sm" ld="detail-search" placeholder="關鍵字搜尋 ..."></div><div class="ml-2"><div class="btn btn-sm btn-outline-secondary d-flex align-items-center" data-ldcv-set="">關閉表格 <i class="i-close"></i></div></div></div><div ld="detail"></div></div></div></div></div><div class="w-100 ld ld-over-inverse running" id="root" ld="loader"><div class="ld" style="width:100%;height:100%;top:0;left:0;"><img style="left:0;right:0;margin:-2.5em auto 0;width:5em;height:5em;" src="/assets/img/loader.svg"><div style="width:max-content;left:0;right:0;margin:2.5em auto 0;text-align:center;"><div class="text-sm">程式載入中<br>請稍候 ...</div></div></div><div class="h-100 d-flex flex-column"><div style="padding:1em 1em 0"><div class="pnl" data-name="title"><div class="header"><div class="mr-5"><div class="text-hl">主題產業數據儀表板</div><div class="text-sm text-white"><a class="text-white" href="https://taicca.tw" rel="noopener noreferrer">&#x00ab; 文化內容策進院</a><span>&nbsp;/ 策略研究處</span></div></div><div class="text-lg text-hl mr-4 entry active" ld="category switch" data-target="movie-tw">每週電影票房資訊</div><div class="text-lg text-hl mr-4 entry" ld="category switch" data-target="book-comic">每季聯合圖書館藏資訊</div><div class="flex-grow-1"></div><div class="d-flex"><div class="btn btn-light mr-2 text-nowrap" ld="show-detail">表格檢視</div><div class="dropdown"><div class="btn btn-light dropdown-toggle d-flex align-items-center" data-toggle="dropdown"><div>時段：</div><div class="mx-2" style="line-height:1em;white-space:pre" ld="date-range">近半年</div></div><div class="dropdown-menu dropdown-menu-right shadow-sm"><div class="dropdown-item" ld="date-preset" data-name="all">全部時段</div><div class="dropdown-item" ld="date-preset" data-name="1q">最近一季</div><div class="dropdown-item" ld="date-preset" data-name="1y">最近一年</div><div class="dropdown-divider"></div><div class="dropdown-header">時段起點</div><div class="dropdown-item"><select class="form-control" ld="date-picker" data-type="start" style="width:9em"><option ld-each="date"></option></select></div><div class="dropdown-header">時段終點</div><div class="dropdown-item"><select class="form-control" ld="date-picker" data-type="end" style="width:9em"><option ld-each="date"></option></select></div></div></div><div class="dropdown"><div class="btn btn-light dropdown-toggle d-flex align-items-center ml-2" data-toggle="dropdown">下載</div><div class="dropdown-menu dropdown-menu-right"><div class="dropdown-header">原始資料</div><div class="dropdown-item" ld="download" data-name="all">全時段</div><div class="dropdown-item" ld="download" data-name="part">選定時段</div><div class="dropdown-divider"></div><div class="dropdown-header">篩選後之資料</div><div class="dropdown-item" ld="download" data-name="part-filter-tw">僅漫畫/小說</div><div class="dropdown-item" ld="download" data-name="part-filter">全部資料</div></div></div></div><div class="d-none"><div class="btn btn-light mr-2 text-nowrap" ld="show-rank">整體排名</div><div class="btn btn-light mr-2 text-nowrap" ld="show-detail">表格檢視</div><div class="dropdown"><div class="btn btn-light dropdown-toggle d-flex align-items-center" data-toggle="dropdown"><div>時段：</div><div class="mx-2" style="line-height:1em;white-space:pre" ld="date-range">近半年</div></div><div class="dropdown-menu dropdown-menu-right shadow-sm"><div class="dropdown-item" ld="date-preset" data-name="all">全部時段</div><div class="dropdown-item" ld="date-preset" data-name="1m">最近一個月</div><div class="dropdown-item" ld="date-preset" data-name="6m">最近半年</div><div class="dropdown-divider"></div><div class="dropdown-header">時段起點</div><div class="dropdown-item"><select class="form-control" ld="date-picker" data-type="start" style="width:9em"><option ld-each="date"></option></select></div><div class="dropdown-header">時段終點</div><div class="dropdown-item"><select class="form-control" ld="date-picker" data-type="end" style="width:9em"><option ld-each="date"></option></select></div></div></div><div class="dropdown"><div class="btn btn-light dropdown-toggle d-flex align-items-center ml-2" data-toggle="dropdown">下載</div><div class="dropdown-menu dropdown-menu-right"><div class="dropdown-header">原始資料</div><div class="dropdown-item" ld="download" data-name="all">全時段</div><div class="dropdown-item" ld="download" data-name="part">選定時段</div><div class="dropdown-divider"></div><div class="dropdown-header">篩選後之資料</div><div class="dropdown-item" ld="download" data-name="part-filter-tw">僅國片</div><div class="dropdown-item" ld="download" data-name="part-filter">國片及外片</div><div class="dropdown-header">註: 篩選資料中, 各部電影僅保留最終一筆數據</div></div></div></div></div></div></div><div class="position-relative" style="flex:1 0 500px"><div class="dashboard hide" ld="dashboard" data-name="book-comic"><div class="pnl widget d-flex flex-column align-items-center justify-content-center clickable trigger" ld="switch" data-target="book-all"><div>點擊此處了解</div><div class="text-lg font-weight-bold">所有書籍館藏狀況 <i class="i-chevron-right"></i></div></div><div class="pnl widget" ld-each="panel" data-name="book-comic"><div class="d-flex"><div class="title mb-0 flex-grow-1 clickable" ld="popup"><span ld="title"></span> <i class="i-magnify"></i></div><div class="clickable" ld="toggle"></div></div><div class="chart" ld="chart"></div></div></div><div class="dashboard hide" ld="dashboard" data-name="book-all"><div class="pnl widget d-flex flex-column align-items-center justify-content-center clickable trigger" ld="switch" data-target="book-comic"><div>點擊此處了解</div><div class="text-lg font-weight-bold text-center d-flex align-items-center justify-content-center"><div class="text-center mr-3"><div>漫畫/小說類</div><div>書籍館藏狀況</div></div><div><i class="i-chevron-right"></i></div></div></div><div class="pnl widget" ld-each="panel" data-name="book-all"><div class="d-flex"><div class="title mb-0 flex-grow-1 clickable" ld="popup"><span ld="title"></span> <i class="i-magnify"></i></div><div class="clickable" ld="toggle"></div></div><div class="chart" ld="chart"></div></div></div><div class="dashboard hide" ld="dashboard" data-name="movie-tw"><div class="pnl widget d-flex flex-column align-items-center justify-content-center clickable trigger" ld="switch" data-target="movie-all"><div>點擊此處了解</div><div class="text-lg font-weight-bold">外片+國片銷售狀況 <i class="i-chevron-right"></i></div></div><div class="pnl widget" ld-each="panel" data-name="movie-tw"><div class="d-flex"><div class="title mb-0 flex-grow-1 clickable" ld="popup"><span ld="title"></span> <i class="i-magnify"></i></div><div class="clickable" ld="toggle"></div></div><div class="chart" ld="chart"></div></div></div><div class="dashboard hide" ld="dashboard" data-name="movie-all"><div class="pnl widget d-flex flex-column align-items-center justify-content-center clickable trigger" ld="switch" data-target="movie-tw"><div>點擊此處了解</div><div class="text-lg font-weight-bold">台灣電影銷售狀況 <i class="i-chevron-right"></i></div></div><div class="pnl widget" ld-each="panel" data-name="movie-all"><div class="title mb-0 flex-grow-1 clickable" ld="popup"><span ld="title"></span> <i class="i-magnify"></i></div><div class="chart" ld="chart"></div></div></div></div></div><div class="ldcv scroll" ld="ldcv" data-name="magnify"><div class="base w-1024 rwd" style="height:80%"><div class="inner card" style="background:#000"><div class="card-body" ld="magnify"></div></div></div></div><div class="position-fixed" style="right:1em;bottom:1em;font-size:12px;padding:.25em .5em;background:#222;color:#ccc;z-index:10;border-radius:3px;box-shadow:0 2px 4px rgba(0,0,0,.3)"><span>資料來源: <a href="https://www.tfi.org.tw/BoxOfficeBulletin/weekly" target="_blank" rel="noopener noreferrer">國影中心</a></span></div></div><div class="p-4 text-white footer text-center"><div class="my-4"><a class="d-block mb-4 mx-auto" href="https://taicca.tw" rel="noopener noreferrer"><img src="/assets/img/logo/footer.svg" alt="taicca logo" width="285px" height="29px" style="max-width:90%;width:450px;height:auto"></a><div>105402 台北市松山區民生東路三段158號5樓 <a href="https://goo.gl/maps/KiMW8eZCXnnwVYB99" rel="noopener noreferrer"><i class="i-location"></i></a></div><div>5F, No. 158, Sec 3, Minsheng E. Rd., Songshan Dist., Taipei City 105402, Taiwan </div><div>TEL (02) 2745-8186 FAX (02) 2749-2436</div><div class="mt-4 font-weight-bold mb-2">聯繫我們</div><div><a href="https://taicca.tw/page/contact" rel="noopener noreferrer"><i class="i-mail"></i></a><a class="mx-4" href="https://www.facebook.com/taicca.tw" rel="noopener noreferrer"><i class="i-fb"></i></a><a href="https://twitter.com/TAICCA_Official" rel="noopener noreferrer"><i class="i-twt"></i></a></div></div></div><script>if(/MSIE|Trident/.exec(navigator.userAgent)) { window.location.href = "/err/ie/" };</script><script type="text/javascript" src="https://polyfill.io/v3/polyfill.min.js?features=ResizeObserver" defer></script><script type="text/javascript" src="/assets/lib/i18next/main/dist/umd/i18next.min.js" defer></script><script type="text/javascript" src="/assets/lib/@loadingio/ldquery/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/ldview/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/lderror/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/@loadingio/debounce.js/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/bootstrap.native/main/dist/bootstrap-native-v4.min.js" defer></script><script type="text/javascript" src="/assets/lib/papaparse/main/papaparse.min.js" defer></script><script type="text/javascript" src="/assets/lib/csv4xls/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/proxise/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/@plotdb/semver/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/@plotdb/csscope/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/@plotdb/rescope/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/@plotdb/block/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/@plotdb/konfig/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/@plotdb/konfig/main/konfig.widget.bootstrap.js" defer></script><script type="text/javascript" src="/assets/lib/ldcolor/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/ldcover/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/ldloader/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/ldslider/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/@loadingio/ldcolorpicker/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/ldpalettepicker/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/ldpalettepicker/main/all.palettes.js" defer></script><script type="text/javascript" src="/assets/lib/@plotdb/sheet/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/ldfile/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/smiltool/main/smiltool.min.js" defer></script><script type="text/javascript" src="/assets/lib/jszip/main/dist/jszip.min.js" defer></script><script type="text/javascript" src="/assets/lib/@loadingio/vscroll/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/@plotdb/datum/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/@plotdb/chart/main/index.min.js" defer></script><script type="text/javascript" src="/assets/lib/@plotdb/chart/main/utils/tint.min.js" defer></script><script type="text/javascript" src="/assets/lib/@plotdb/chart/main/utils/config.min.js" defer></script><script type="text/javascript" src="https://d3js.org/d3.v4.js" defer></script><script type="text/javascript" src="https://d3js.org/d3-array.v2.min.js" defer></script><script type="module">var dashboard,pal;dashboard={layout:{}};pal={colors:["#d55741","#e8c05c","#6ee97d","#7fb2eb","#577aeb","#b376ee"]};(function(t){return t.apply(dashboard)})(function(){var t,x,T,e=this;t={t1:Date.now()};this.pal=pal;this.data={book:{all:{},part:{}},movie:{all:{},part:{}}};this.inited=false;this.loading=false;this.ldcv={};this.chart={"movie-tw":{},"movie-all":{},"book-comic":{},"book-all":{}};this.filters={};this.mode="book-comic";this.dates=x={picked:{},list:[]};T=function(t){var e,n;t==null&&(t=[]);t=t.map(function(t){return new Date(t).getTime()});t.sort(function(t,e){if(t<e){return-1}else if(t>e){return 1}else{return 0}});e=t.length;n=1;while(n<e){if(t[n]-t[n-1]>86400*8*1e3){t.splice(n,0,t[n-1]+86400*7*1e3);continue}else{n++}}t=t.map(function(t,e){var n,r;t=new Date(t);n=t.getYear()+1900;r=(t.getMonth()+1+"").padStart(2,"0");t=(t.getDate()+"").padStart(2,"0");return n+"/"+r+"/"+t});return t};import$(this,{init:function(){var t,e,u=this;t={module:function(t){var e,n,r,i;e=t.name,n=t.version,r=t.path,i=t.type;return i==="block"?"/assets/block/"+e+"/"+n+"/index.html":!/^d3/.exec(e)?"/assets/lib/"+e+"/"+n+"/"+(r||"index.min.js"):"/assets/lib/"+e+"/main/"+r}};e=new rescope({prejs:["https://polyfill.io/v3/polyfill.min.js?features=ResizeObserver"],registry:t.module});return e.init().then(function(){u.mgr=new block.manager({registry:t.module,rescope:e});return i18next.init({supportedLng:["en","zh-TW"],fallbackLng:"zh-TW"})}).then(function(){return block.i18n.use(i18next)}).then(function(){return u.mgr.init()}).then(function(){return u.view=new ldview({root:document.body,initRender:false,action:{click:{"date-preset":function(t){var e,n,r,i,a;e=t.node;n=e.getAttribute("data-name");switch(n){case"all":r=u.dates.picked;r.start=u.dates.list[0];r.end=(i=u.dates.list)[i.length-1];break;case"1m":a=Date.now()-864e5*31;u.dates.picked.start=u.dates.list.filter(function(t){return new Date(t).getTime()>=a})[0]||(r=u.dates.list)[r.length-1];u.dates.picked.end=(r=u.dates.list)[r.length-1];break;case"6m":a=Date.now()-864e5*182;u.dates.picked.start=u.dates.list.filter(function(t){return new Date(t).getTime()>=a})[0]||(r=u.dates.list)[r.length-1];u.dates.picked.end=(r=u.dates.list)[r.length-1];break;case"1q":a=Date.now()-864e5*31*3;u.dates.picked.start=u.dates.list.filter(function(t){return new Date(t).getTime()>=a})[0]||(r=u.dates.list)[r.length-1];u.dates.picked.end=(r=u.dates.list)[r.length-1];break;case"1y":a=Date.now()-864e5*366;u.dates.picked.start=u.dates.list.filter(function(t){return new Date(t).getTime()>=a})[0]||(r=u.dates.list)[r.length-1];u.dates.picked.end=(r=u.dates.list)[r.length-1]}u.view.render("date-picker","date-range");return u.filter()},download:function(t){var e,n,r,i,a,o,l,s;e=t.node;n=e.getAttribute("data-name");r=x.picked.start||x.list[0];i=x.picked.end||(a=x.list)[a.length-1];o=u.data["movie"];l=o.raw.head;if(n==="part"){s=u.raw.body.filter(function(t){var e,n,r,i,a;e=[t["起計日"],t["迄計日"]],n=e[0],r=e[1];i=x.picked.start||x.list[0];a=x.picked.end||(e=x.list)[e.length-1];return n>=i&&n<=a&&r>=i&&r<=a})}else if(n==="part-filter-tw"){s=o.part.movie.tw}else if(n==="part-filter"){s=o.part.movie.all}else{s=o.raw.body}o=s.map(function(n){return l.map(function(t){var e;e=n[t];return e=Array.isArray(e)?e.join(","):!(e!=null)?"":e+""})});o=o.map(function(t){var e;e=t.slice(0,4);e[1]=e[1].replace(/^(..)/,"$1/");e[3]=e[3].replace(/^(..)/,"$1/");return[e[0]+"/"+e[1],e[2]+"/"+e[3]].concat(t.slice(4))});o=[["起計日","迄計日"].concat(l.slice(4))].concat(o);return ldfile.download({blob:csv4xls.toBlob(o),name:"result.csv"})},"date-picker":function(t){var e;e=t.evt;return e.stopPropagation()},"show-detail":function(){return u.ldcv.detail.toggle()},"show-rank":function(){return u.ldcv.rank.toggle()},switch:function(t){var e,n;e=t.node,n=t.views;u.mode=e.getAttribute("data-target");n[0].render("dashboard","category");return u.renderChart()},detail:function(t){var e,n,r,i,a,o;e=t.node,n=t.evt;if(!(r=ld$.parent(n.target,".cell",e))){return}if(!(i=ld$.find(r,"i",0))){return}a=+i.getAttribute("data-idx");o=u.sheetSort[a]=u.sheetSort[a]*-1;u.sheetData.sort(function(t,e){var n;if(typeof t[a]==="object"){return-1}else if(typeof e[a]==="object"){return 1}n=t[a]<e[a]?-1:t[a]>e[a]?1:0;return n*o});u.sheet.data(u.sheetData.filter(function(t,e){if(!(e&&u.sheetKeyword)){return true}return~JSON.stringify(t).indexOf(u.sheetKeyword)}));u.sheetHead.map(function(t,e){return ld$.find(t.node,"i",0).setAttribute("class","")});return i.classList.add(o>0?"i-dart-down":"i-dart-up")}},input:{"detail-search":debounce(350,function(t){var e,n;e=t.node;u.sheetKeyword=n=e.value||"";return u.sheet.data(u.sheetData.filter(function(t,e){if(!(e&&n)){return true}return~JSON.stringify(t).indexOf(n)}))})},change:{"date-picker":function(t){var e,n;e=t.node;n=e.getAttribute("data-type");u.dates.picked[n]=e.value;u.filter();return u.view.render("date-range")}}},init:{ldcv:function(t){var e;e=t.node;return u.ldcv[e.getAttribute("data-name")]=new ldcover({root:e,resident:true})}},handler:{category:function(t){var e,n,r;e=t.node,n=t.views;r=e.getAttribute("data-target").split("-")[0];return e.classList.toggle("active",(u.mode||"").split("-")[0]===r)},loader:function(t){var e;e=t.node;return e.classList.toggle("running",!u.inited||u.loading)},"date-range":function(t){var e,n;e=t.node;if(u.dates.picked.start===u.dates.list[0]&&u.dates.picked.end===(n=u.dates.list)[n.length-1]){e.textContent="全部";return e.classList.remove("text-sm")}else{e.textContent="由 "+u.dates.picked.start+"\n至 "+u.dates.picked.end;return e.classList.add("text-sm")}},"date-picker":function(t){var e,n;e=t.node;n=e.getAttribute("data-type");return e.value=u.dates.picked[n]},dashboard:function(t){var e,n,r,i;e=t.node;n=e.getAttribute("data-name");e.classList.toggle("hide",n!==u.mode);r=u.layout[n].grid;return i=e.style,i.gridTemplateColumns=r.col.join(" "),i.gridTemplateRows=r.row.join(" "),i},rank:{list:function(t){var e,n;e=t.node;n=u.data["movie"];return n.all.movie.all},view:{handler:{rank:function(t){var e,n,r;e=t.node,n=t.ctx,r=t.idx;return e.textContent=n.rank||1},name:function(t){var e,n;e=t.node,n=t.ctx;return e.textContent=n["中文片名"].substring(0,30)},country:function(t){var e,n,r;e=t.node,n=t.ctx;r=n["國別地區"];e.textContent=r.length>1?"多國":r[0];e.classList.toggle("bg-primary",in$("中華民國",r));return e.classList.toggle("bg-secondary",!in$("中華民國",r))},revenue:function(t){var e,n;e=t.node,n=t.ctx;return e.textContent=n["累計銷售金額"]}}}},panel:{list:function(t){var e,n,r;e=t.node;n=e.getAttribute("data-name");r=u.layout[n].panels;return r},key:function(t){return t.idx},view:{action:{click:{popup:function(t){var e,n,r,i,a,o;e=t.ctx;n=e.name;if(!((r=u.chart[e.layout])[n]||(r[n]={})).info){i=e.layout.split("-")[0];u.chart[e.layout][n].info=u.chart[e.layout][n].call((r=u.data[i]).part||(r.part={}),u.data[i])}a=e.chart||((r=(o=u.chart[e.layout])[n]||(o[n]={})).info||(r.info={})).type;u.ldcv.magnify.toggle(true);return u.prepareChart({chart:a,name:n,root:u.view.get("magnify"),layout:e.layout,magnify:true})},toggle:function(t){var e,n,r;e=t.views,n=t.ctx;r=u.layout[n.layout].panels.filter(function(t){return t.name===n.toggle.name})[0];n.active=false;r.active=true;return u.view.render()}}},text:{title:function(t){var e,n,r,i;e=t.ctx;return e.title||((n=(r=u.chart[u.mode])[i=e.name]||(r[i]={})).info||(n.info={})).title||e.name},toggle:function(t){var e;e=t.ctx;if(!e.toggle){return}return e.toggle.text||e.toggle.name}},init:{chart:function(t){var e,n,r,i,a,o,l,s;e=t.node,n=t.ctx;r=n.name;if(!((i=u.chart[n.layout])[r]||(i[r]={})).info){a=n.layout.split("-")[0];u.chart[n.layout][r].info=u.chart[n.layout][r].call((i=u.data[a]).part||(i.part={}),u.data[a])}o=n.chart||((i=(l=u.chart[n.layout])[r]||(l[r]={})).info||(i.info={})).type;s=ld$.parent(e,".pnl");i=s.style;i.gridColumn=n.col[0]+" / span "+n.col[1];i.gridRow=n.row[0]+" / span "+n.row[1];if(n["class"]){n["class"].map(function(t){return s.classList.toggle(t,true)})}return(u.initPromise||(u.initPromise=[])).push(u.prepareChart({chart:o,name:r,root:e,layout:n.layout}))}},handler:{"@":function(t){var e,n;e=t.node,n=t.ctx;return e.classList.toggle("inactive",n.active!=null&&!n.active)}}}},date:{list:function(){return u.dates.list||[]},handler:function(t){var e,n;e=t.node,n=t.data;e.textContent=n;e.setAttribute("value",n);if(u.dates.picked[e.parentNode.getAttribute("data-type")]===n){return e.setAttribute("selected",true)}}}}})}).then(function(){return u.getData()}).then(function(){return u.view.render()}).then(function(){return Promise.all(u.initPromise||[])})},prepareChart:function(t){var e,o,n,l,s,r,u,c=this;e=t.chart,o=t.name,n=t.root,l=t.layout,s=t.config,r=t.data,u=t.magnify;return Promise.resolve().then(function(){if(!u){return}if(c.chart.magnify){c.chart.magnify.chart.destroy()}return n.innerHTML=""}).then(function(){return c.mgr.get({name:e,version:"0.0.1"})}).then(function(t){return t.create({data:r})}).then(function(t){return t.attach({root:n,data:{delayRender:true}}).then(function(){return t["interface"]()})}).then(function(e){var n,t,r,i,a;n=(t=(r=c.chart[l])[o]||(r[o]={})).info||(t.info={});if(u){c.chart.magnify={info:n,chart:e}}else{((t=c.chart[l])[o]||(t[o]={})).chart=e}i=import$(import$({},s||{}),n.cfg||{});if(!i.palette){i.palette=pal}e.config(i);e.on("filter",function(t){c.filter();c.filters[o]=t;if(n.filter){return n.filter({chart:e,filter:t})}});if(a=n.bind){return e.setRaw(a)}})},renderChart:function(){var t,e,n,r,i,a,o=[];for(t in e=this.chart[this.mode]){n=e[t];r=this.chart[this.mode][t],i=r.chart,a=r.info;if(!(i&&a)){continue}if(a.dash!==this.mode){continue}i.resize();o.push(i.render())}return o},loaderWrap:function(t){var e=this;this.loading=true;this.view.render("loader");return debounce(100).then(function(){return t()}).then(function(){return debounce(300)}).then(function(){e.loading=false;return e.view.render("loader")})},filter:debounce(300,function(){var o=this;return this.loaderWrap(function(){return debounce(100).then(function(){var t,e,n,r,i,a;t=o.data["movie"];o.parse["movie-tw"].call(t.all,t.raw);o.parse["movie-tw"].call(t.part,t.raw,o.filters);for(e in n=o.chart[o.mode]){r=n[e];if(!(i=o.chart[o.mode][e].chart)){continue}a=import$(o.chart[o.mode][e].info,r.call(t.part,t,o.filters[e]));i.setRaw(a.bind);i.parse()}o.renderChart();o.view.render("rank");return debounce(300)})})}),parse:{"movie-tw":function(t,e){var n,r,i,a,o,l,s,u,c,d,f,h,p,m,v,g,b,w=this;n=t.head,r=t.body;this.movie={all:[],byCountry:{},continentmap:{},raw:{}};i={};a=x.picked.start||x.list[0];o=x.picked.end||(l=x.list)[l.length-1];r=r.filter(function(t){var e,n,r,i,a;e=[t["起計日"],t["迄計日"]],n=e[0],r=e[1];i=x.picked.start||x.list[0];a=x.picked.end||(e=x.list)[e.length-1];return n>=i&&n<=a&&r>=i&&r<=a});r.map(function(t){var e;e=t["中文片名"];if(!i[e]||+i[e]["累計銷售金額"]<+t["累計銷售金額"]){return i[e]=t}});for(s in i){u=i[s];i[s]=JSON.parse(JSON.stringify(u))}r.map(function(t){var e;e=t["中文片名"];if(i[e]&&+i[e]["上映院數"]<+t["上映院數"]){return i[e]["上映院數"]=+t["上映院數"]}});this.movie.all=function(){var t,e=[];for(s in t=i){u=t[s];e.push(u)}return e}();this.movie.tw=this.movie.all.filter(function(t){return in$("中華民國",t["國別地區"])});if(e){c=[["revenue","國片累計銷售金額分布","累計銷售金額","tw"],["ticket","國片累計銷售票數分布","累計銷售票數","tw"],["theatre","國片上映院數分布","上映院數","tw"],["revenue","電影累計銷售金額分布","累計銷售金額","all"],["ticket","電影累計銷售票數分布","累計銷售票數","all"],["theatre","電影上映院數分布","上映院數","all"]];for(d=0,f=c.length;d<f;++d){h=c[d];if(!((p=e[h[1]])&&p.name)){continue}p=p.name.value.map(y);this.movie[h[3]]=this.movie[h[3]].filter(k)}if(e["出品人比例"]){m=e["出品人比例"].name||{type:"exclude",value:[]};if(m.type!=="exclude"){console.error("expected filter type for 出品人比例 should be `exclude`")}m=m.value||[];this.movie.tw=this.movie.tw.filter(function(t){return t["出品"].filter(function(t){return!in$(t,m)}).length})}}this.movie.all.map(function(r){return(r["國別地區"]||[]).map(function(t,e){var n;((n=w.movie.byCountry)[t]||(n[t]=[])).push(r);return w.movie.continentmap[t]=r["洲別"][e]})});this.bins={tw:{},all:{}};this.binned={tw:{},all:{}};v={revenue:[0,1e3,5e3,1e4,1e5,1e6,1e7,1e8,1e9,1e11],ticket:[0,100,500,1e3,5e3,1e4,5e4,1e5,5e5,1e6],theatre:[0,5,10,15,20,30,50,70,90]};this.binThresholds={tw:v,all:v};this.bins.all.revenue=d3.bin().thresholds(this.binThresholds.all.revenue);this.bins.all.ticket=d3.bin().thresholds(this.binThresholds.all.ticket);this.bins.all.theatre=d3.bin().thresholds(this.binThresholds.all.theatre);this.bins.tw.revenue=d3.bin().thresholds(this.binThresholds.tw.revenue);this.bins.tw.ticket=d3.bin().thresholds(this.binThresholds.tw.ticket);this.bins.tw.theatre=d3.bin().thresholds(this.binThresholds.tw.theatre);this.binned.all.revenue=this.bins.all.revenue(this.movie.all.map(function(t){return t["累計銷售金額"]}));this.binned.all.ticket=this.bins.all.ticket(this.movie.all.map(function(t){return t["累計銷售票數"]}));this.binned.all.theatre=this.bins.all.theatre(this.movie.all.map(function(t){return t["上映院數"]}));this.binned.tw.revenue=this.bins.tw.revenue(this.movie.tw.map(function(t){return t["累計銷售金額"]}));this.binned.tw.ticket=this.bins.tw.ticket(this.movie.tw.map(function(t){return t["累計銷售票數"]}));this.binned.tw.theatre=this.bins.tw.theatre(this.movie.tw.map(function(t){return t["上映院數"]}));this.movie.all.sort(function(t,e){return e["累計銷售金額"]-t["累計銷售金額"]});this.movie.all.map(function(t,e){return t.rank=e+1});this.total={all:{revenue:this.movie.all.reduce(function(t,e){return t+e["累計銷售金額"]},0),ticket:this.movie.all.reduce(function(t,e){return t+e["累計銷售票數"]},0)},tw:{revenue:this.movie.tw.reduce(function(t,e){return t+e["累計銷售金額"]},0),ticket:this.movie.tw.reduce(function(t,e){return t+e["累計銷售票數"]},0)}};g=n.slice(5);g=g.filter(function(t){return!(t==="銷售票數"||t==="銷售金額")});b={tw:{},all:{}};["all","tw"].map(function(e){return w.movie[e].map(function(t){return b[e][t["中文片名"]]=true})});this.movie.all.map(function(){return b.all});this.date={revenue:{}};r.map(function(t){var e,n,r;e=t["迄計日"];n=t["銷售金額"];r=w.date.revenue[e]||(w.date.revenue[e]={});r.date=e;if(b.all[t["中文片名"]]){r.all=(r.all||0)+n}if(b.tw[t["中文片名"]]){if(t["來源"]==="國內"){r.tw=(r.tw||0)+n}}if(t["來源"]!=="國內"){return r.other=(r.other||0)+n}});return T(function(){var t=[];for(s in this.date.revenue){t.push(s)}return t}.call(this)).map(function(t){if(w.date.revenue[t]){return}return w.date.revenue[t]={date:t,all:0,tw:0,other:0}});function y(t){var e,n,r,i,a;e=w.binThresholds[h[3]][h[0]];if(!~(n=e.indexOf(+t))){for(r=0,i=e.length;r<i;++r){a=r;if(e[a]<+t){continue}n=a;break}if(!~n){n=e.length}}return[e[n-1],+t]}function k(t){var e;e=t[h[2]];return p.filter(function(t){return e>=t[0]&&e<=t[1]}).length}}},getData:function(){var t=this;return this.fetch.movie.apply(this).then(function(){return t.fetch.book.apply(t)})},fetch:{book:function(){var r=this;return ld$.fetch("/assets/data/nbi/min.json",{method:"GET"},{type:"json"}).then(function(e){var t,n;t=e.data.map(function(t){return{year:e.table.year[t[0]]||"",pub:e.table.pub[t[1]]||"",idx:t[2],words:t[3].map(function(t){return e.table.words[t]||""}),county:e.table.county[t[4]]||"其它"}});n=t.filter(function(t){if(/^947[45]/.exec(t.idx)||/^889/.exec(t.idx)||/^8..57/.exec(t.idx)){return true}else{return false}});return r.data["book"].all=r.data["book"].part={data:t,comic:n,raw:e}})},movie:function(){var g=this;return ld$.fetch("/assets/data/tfi/all.json",{method:"GET"},{type:"json"}).then(function(t){var e,n,r,i,a,o,l,s,u,c,d,f,h,p,m,v=[];e=t.head;n=t.body.map(function(n){return Object.fromEntries(e.map(function(t,e){return[t,n[e]]}))});g.data["movie"]=r={all:{},part:{},raw:i={name:"電影票房資訊",head:e,body:n}};n.map(function(t){t["起計日"]=t["src-year"]+"/"+t["src-date"].substring(0,2)+"/"+t["src-date"].substring(2);t["迄計日"]=t["des-year"]+"/"+t["des-date"].substring(0,2)+"/"+t["des-date"].substring(2);t["來源"]=in$("中華民國",t["國別地區"])?"國內":"國外";t["中文片名"]=t["中文片名"].replace(/ /g,"");return t["申請人"]=t["申請人"].replace(/ /g,"")});g.dates.list=Array.from(new Set(n.map(function(t){return t["迄計日"]})));g.dates.list=T(g.dates.list);g.dates.picked.end=(a=g.dates.list)[a.length-1];o=new Date(g.dates.picked.end).getTime()-864e5*182;g.dates.picked.start=g.dates.list.filter(function(t){return new Date(t).getTime()>=o})[0]||(a=g.dates.list)[a.length-1];g.parse["movie-tw"].call(r.all,i);g.parse["movie-tw"].call(r.part,i);l=["國別地區","中文片名","上映日期","上映院數","累計銷售票數","累計銷售金額","申請人","出品"];g.sheetHead=s=l.map(function(t,e){var n;n=document.createElement("div");n.classList.add("w-100","h-100","d-flex","justify-content-between","align-items-center");n.innerHTML="<div>"+t+'</div><div class="text-sm mx-1"><i class="" data-idx="'+e+'"></div>';return{type:"dom",node:n}});g.sheetSort=l.map(function(){return-1});g.sheetData=[s].concat(r.all.movie.all.map(function(e){return l.map(function(t){if(Array.isArray(e[t])){return e[t].join("\n")}else{return e[t]}})}));g.sheet=new sheet({root:g.view.get("detail"),data:g.sheetData,frozen:{row:1},size:{col:["6em","15em","7em","6em","8em","8em","24em"]},editing:false});for(u=0,c=(a=["movie-all","movie-tw"]).length;u<c;++u){d=a[u];f=[];for(h in p=g.chart[d]){m=p[h];f.push(g.chart[d][h].info=m.call(r.part,r))}v.push(f)}return v})}}});return this.init().then(function(){e.inited=true;return e.view.render("loader")}).then(function(){return console.log("[perf] startup elapsed time: "+((Date.now()-t.t1)/1e3).toFixed(2)+"s")})});function import$(t,e){var n={}.hasOwnProperty;for(var r in e)if(n.call(e,r))t[r]=e[r];return t}function in$(t,e){var n=-1,r=e.length>>>0;while(++n<r)if(t===e[n])return true;return false}(function(n){return n.apply(dashboard)})(function(){this.layout["book-comic"]={grid:{col:["1fr","1fr","1fr","2fr","1fr","2fr"],row:["2fr","2fr","2fr","2fr"]},panels:[{row:[1,1],col:[1,1],name:"書籍總數",class:["highlight","color","color-film"],title:"漫畫/小說書籍總數"},{row:[1,1],col:[2,1],name:"出版商總數",class:["highlight","color","color-revenue"],title:"漫畫/小說出版商總數"},{row:[2,4],col:[6,1],name:"出版商佔比",title:"館藏量前100名出版商佔比"},{row:[1,2],col:[3,3],name:"歷年出版商排名",title:"歷年出版商排名(依整體館藏量排序)"},{row:[3,2],col:[3,2],name:"出版商地理分布"},{row:[3,2],col:[5,1],name:"分類佔比"},{row:[2,3],col:[1,2],name:"主題文字雲"}]};this.layout["book-comic"].panels.map(function(n,o){return n.idx=o,n.layout="book-comic",n});this.chart["book-comic"]["書籍總數"]=function(){var n;n={raw:[{val:this.comic.length,name:"書本數",unit:"種"}],binding:{name:{key:"name"},value:{key:"val",unit:"種"}}};return{bind:n,cfg:{},type:"number",dash:"book-comic"}};this.chart["book-comic"]["出版商總數"]=function(){var n;n={raw:[{val:this.raw.table.pub.length,name:"出版商數",unit:"間"}],binding:{name:{key:"name"},value:{key:"val",unit:"間"}}};return{bind:n,cfg:{},type:"number",dash:"book-comic"}};this.chart["book-comic"]["再版次數分布"]=function(){var n,o;n=pal.colors[0];o={tickFormat:".0~s",toggleLegend:false,tickCount:3,dancing:false,legend:{enabled:false},xaxis:{showCaption:false},pal:{colors:[ldcolor.darker(n,5),n]}};return{bind:{},cfg:o,type:"bar",dash:"book-comic"}};this.chart["book-comic"]["出版商地理分布"]=function(n){var o,r,t,e,i,c,a;o={};this.comic.map(function(n){return o[n.county]=(o[n.county]||0)+1});t=[];for(e in o){i=o[e];t.push({k:e,v:i})}r=t;c={raw:r,binding:{name:{key:"k"},color:{key:"v"}}};a={legend:{format:"~d",exp:.62}};return{bind:c,cfg:a,type:"taiwan-map",dash:"book-comic"}};this.chart["book-comic"]["歷年出版商排名"]=function(){var t,e,n,o,r,i,c,a,u,l;t={};this.comic.map(function(n){var o;return(t[o=n.year]||(t[o]={}))[n.pub]=((t[o=n.year]||(t[o]={}))[n.pub]||0)+1});e={};for(n in t){o=t[n];i=[];for(c in o){a=o[c];i.push({k:c,v:a})}r=i;r.sort(s);r.splice(0,5).map(f)}i=[];for(c in e){i.push({k:c,v:a})}e=i;e.sort(function(n,o){return o.v-n.v});e=e.splice(0,8);e=e.map(function(n){return n.k});r=this.raw.table.year.map(function(o){var r;r={y:o};e.map(function(n){return r[n]=(t[o]||(t[o]={}))[n]||0});return r});u={raw:r,binding:{order:{key:"y",name:"年份"},value:e.map(function(n){return{key:n,name:n}})}};l={mode:"line",legend:{enabled:true,selectable:false}};return{bind:u,cfg:l,type:"line",dash:"book-comic"};function s(n,o){return o.v-n.v}function f(n){var o;if(!n.k){return}o=n.k.substring(0,4);return e[o]=(e[o]||0)+n.v}};this.chart["book-comic"]["出版商佔比"]=function(){var n,o,r,t,e,i,c;n={line:"#fff",collapse:{enabled:true,method:"count",threshold:15}};o={};this.comic.map(function(n){return o[n.pub]=(o[n.pub]||0)+1});t=[];for(e in o){i=o[e];t.push({k:e,v:i})}r=t;r.sort(function(n,o){return o.v-n.v});r=r.splice(0,100);c={raw:r,binding:{name:{key:"k"},value:{key:"v"}}};return{bind:c,cfg:n,type:"percent-list",dash:"book-comic"}};this.chart["book-comic"]["主題文字雲"]=function(){var o,n,r,t,e,i,c;o={};this.comic.map(function(n){return n.words.map(function(n){return o[n]=(o[n]||0)+1})});r=[];for(t in o){e=o[t];r.push({k:t,v:e})}n=r;n.sort(function(n,o){return o.v-n.v});n.map(function(n){return n.v=Math.sqrt(n.v)});i={raw:n,binding:{text:{key:"k"},value:{key:"v"}}};c={font:{size:32},color:{random:true}};return{bind:i,cfg:c,type:"wordcloud",dash:"book-comic"}};return this.chart["book-comic"]["分類佔比"]=function(n){var r,t,e,o,i,c,a,u;r={};this.comic.map(function(n){var o;o=n.idx.substring(0,2)+"";return r[o]=(r[o]||0)+1});t={10:"哲學",11:"思想",12:"中國哲學",13:"東方哲學",14:"西洋哲學",15:"邏輯",16:"形上學",17:"心理學",18:"美學",19:"倫理學",20:"宗教",21:"比較宗教學",22:"佛教",23:"道教",24:"基督教",25:"回教",26:"猶太教",27:"其他宗教",28:"神話",29:"術數；迷信",30:"科學",31:"數學",32:"天文學",33:"物理學",34:"化學",35:"地球科學；地質學",36:"生物科學",37:"植物學",38:"動物學",39:"人類學",40:"應用科學",41:"醫藥",42:"家政",43:"農業",44:"工程學",45:"礦冶",46:"化學工程",47:"製造",48:"商業",49:"商學",50:"社會科學",51:"統計學",52:"教育",53:"禮俗禮儀",54:"社會學",55:"經濟學",56:"財政學",57:"政治學",58:"法律",59:"軍事",60:"史地",61:"中>國史地",62:"中國斷代史",63:"中國各代文化史",64:"中國外交史",65:"中國史料",66:"中國地理總志",67:"中國地方志",68:"中國地理類志",69:"中國遊記",70:"世界史地",71:"世界史地",72:"海洋志",73:"亞洲史地",74:"西洋/歐洲史地",75:"美洲史地",76:"非洲史地",77:"大洋洲史地",78:"傳記",79:"古物考古學",80:"語言學",81:"文學",82:"中國文學",83:"中國文學總集",84:"中國文學別集",85:"中國各種文學",86:"東方文學",87:"西洋文學",88:"俄國文學",89:">新聞學",90:"藝術",91:"音樂",92:"建築藝術",93:"雕塑",94:"書畫",95:"攝影",96:"應用美術",97:"技藝",98:">戲劇",99:"遊藝及休閒活動","00":"特藏","01":"目錄學","02":"圖書館","03":"國學","04":"類書","05":"期刊","06":"會社","07":"論叢","08":"普通叢書","09":"經學"};e={0:"總類",1:"哲學",2:"宗教",3:"自然科學",4:"應用科學",5:"社會科學",6:"中國史地",7:"世界史地",8:"語文",9:"藝術","":"其它"};o=function(){var n,o=[];for(i in n=r){c=n[i];o.push({k:i,v:c})}return o}().map(function(n){var o,r;o=(r={c:e[n.k.substring(0,1)]},r.k=n.k,r.v=n.v,r);o.k=t[o.k]||"其它";return o});a={raw:o,binding:{area:{key:"v"},name:{key:"k"},category:{key:"c"}}};u={legend:{enabled:false,selectable:false,position:"bottom"}};return{bind:a,cfg:u,type:"treemap",dash:"book-all"}}});(function(n){return n.apply(dashboard)})(function(){this.layout["book-all"]={grid:{col:["1fr","1fr","1fr","2fr","1fr","2fr"],row:["2fr","2fr","2fr","2fr"]},panels:[{row:[1,1],col:[1,1],name:"書籍總數",class:["highlight","color","color-film"]},{row:[1,1],col:[2,1],name:"出版商總數",class:["highlight","color","color-revenue"]},{row:[2,4],col:[6,1],name:"出版商佔比",title:"館藏量前一百名之出版商佔比"},{row:[1,2],col:[3,3],name:"歷年出版商排名",title:"歷年出版商排名(依整體館藏量排序)"},{row:[3,2],col:[3,3],name:"圖書分類佔比"},{row:[2,3],col:[1,2],name:"主題文字雲"}]};this.layout["book-all"].panels.map(function(n,r){return n.idx=r,n.layout="book-all",n});this.chart["book-all"]["書籍總數"]=function(){var n;n={raw:[{val:this.data.length,name:"書本數",unit:"種"}],binding:{name:{key:"name"},value:{key:"val",unit:"種"}}};return{bind:n,cfg:{},type:"number",dash:"book-all"}};this.chart["book-all"]["出版商總數"]=function(){var n;n={raw:[{val:this.raw.table.pub.length,name:"出版商數",unit:"間"}],binding:{name:{key:"name"},value:{key:"val",unit:"間"}}};return{bind:n,cfg:{},type:"number",dash:"book-all"}};this.chart["book-all"]["再版次數分布"]=function(){var n,r;n=pal.colors[0];r={tickFormat:".0~s",toggleLegend:false,tickCount:3,dancing:false,legend:{enabled:false},xaxis:{showCaption:false},pal:{colors:[ldcolor.darker(n,5),n]}};return{bind:{},cfg:r,type:"bar",dash:"book-all"}};this.chart["book-all"]["圖書分類佔比"]=function(n){var t,a,e,r,o,l,i,u;t={};this.data.map(function(n){var r;r=n.idx.substring(0,2)+"";return t[r]=(t[r]||0)+1});a={10:"哲學",11:"思想",12:"中國哲學",13:"東方哲學",14:"西洋哲學",15:"邏輯",16:"形上學",17:"心理學",18:"美學",19:"倫理學",20:"宗教",21:"比較宗教學",22:"佛教",23:"道教",24:"基督教",25:"回教",26:"猶太教",27:"其他宗教",28:"神話",29:"術數；迷信",30:"科學",31:"數學",32:"天文學",33:"物理學",34:"化學",35:"地球科學；地質學",36:"生物科學",37:"植物學",38:"動物學",39:"人類學",40:"應用科學",41:"醫藥",42:"家政",43:"農業",44:"工程學",45:"礦冶",46:"化學工程",47:"製造",48:"商業",49:"商學",50:"社會科學",51:"統計學",52:"教育",53:"禮俗禮儀",54:"社會學",55:"經濟學",56:"財政學",57:"政治學",58:"法律",59:"軍事",60:"史地",61:"中>國史地",62:"中國斷代史",63:"中國各代文化史",64:"中國外交史",65:"中國史料",66:"中國地理總志",67:"中國地方志",68:"中國地理類志",69:"中國遊記",70:"世界史地",71:"世界史地",72:"海洋志",73:"亞洲史地",74:"西洋/歐洲史地",75:"美洲史地",76:"非洲史地",77:"大洋洲史地",78:"傳記",79:"古物考古學",80:"語言學",81:"文學",82:"中國文學",83:"中國文學總集",84:"中國文學別集",85:"中國各種文學",86:"東方文學",87:"西洋文學",88:"俄國文學",89:">新聞學",90:"藝術",91:"音樂",92:"建築藝術",93:"雕塑",94:"書畫",95:"攝影",96:"應用美術",97:"技藝",98:">戲劇",99:"遊藝及休閒活動","00":"特藏","01":"目錄學","02":"圖書館","03":"國學","04":"類書","05":"期刊","06":"會社","07":"論叢","08":"普通叢書","09":"經學"};e={0:"總類",1:"哲學",2:"宗教",3:"自然科學",4:"應用科學",5:"社會科學",6:"中國史地",7:"世界史地",8:"語文",9:"藝術","":"其它"};r=function(){var n,r=[];for(o in n=t){l=n[o];r.push({k:o,v:l})}return r}().map(function(n){var r,t;r=(t={c:e[n.k.substring(0,1)]},t.k=n.k,t.v=n.v,t);r.k=a[r.k]||"其它";return r});i={raw:r,binding:{area:{key:"v"},name:{key:"k"},category:{key:"c"}}};u={legend:{enabled:true,selectable:true}};return{bind:i,cfg:u,type:"treemap",dash:"book-all"}};this.chart["book-all"]["歷年出版商排名"]=function(){var a,e,n,r,t,o,l,i,u,c;a={};this.data.map(function(n){var r;return(a[r=n.year]||(a[r]={}))[n.pub]=((a[r=n.year]||(a[r]={}))[n.pub]||0)+1});e={};for(n in a){r=a[n];o=[];for(l in r){i=r[l];o.push({k:l,v:i})}t=o;t.sort(s);t.splice(0,5).map(f)}o=[];for(l in e){o.push({k:l,v:i})}e=o;e.sort(function(n,r){return r.v-n.v});e=e.splice(0,8);e=e.map(function(n){return n.k});t=this.raw.table.year.map(function(r){var t;t={y:r};e.map(function(n){return t[n]=(a[r]||(a[r]={}))[n]||0});return t});u={raw:t,binding:{order:{key:"y",name:"年份"},value:e.map(function(n){return{key:n,name:n}})}};c={mode:"bump",legend:{enabled:true,selectable:true}};return{bind:u,cfg:c,type:"line",dash:"book-all"};function s(n,r){return r.v-n.v}function f(n){var r;if(!n.k){return}r=n.k.substring(0,4);return e[r]=(e[r]||0)+n.v}};this.chart["book-all"]["出版商佔比"]=function(){var n,t,r,a,e,o,l;n={line:"#fff",collapse:{enabled:true,method:"count",threshold:15}};t={};this.data.map(function(n){return t[n.pub]=(t[n.pub]||0)+1});r=function(){var n,r=[];for(a in n=t){e=n[a];r.push({k:a,v:e})}return r}().filter(function(n){return n.k});r.sort(function(n,r){return r.v-n.v});o=r.splice(0,100);l={raw:o,binding:{name:{key:"k"},value:{key:"v"}}};return{bind:l,cfg:n,type:"percent-list",dash:"book-all"}};return this.chart["book-all"]["主題文字雲"]=function(){var r,n,t,a,e,o,l;r={};this.data.map(function(n){return n.words.map(function(n){return r[n]=(r[n]||0)+1})});t=[];for(a in r){e=r[a];t.push({k:a,v:e})}n=t;n.sort(function(n,r){return r.v-n.v});n.map(function(n){return n.v=Math.sqrt(n.v)});o={raw:n,binding:{text:{key:"k"},value:{key:"v"}}};l={font:{size:32},color:{random:true}};return{bind:o,cfg:l,type:"wordcloud",dash:"book-all"}}});(function(e){return e.apply(dashboard)})(function(){this.layout["movie-tw"]={grid:{col:["1fr","1fr","1fr","2fr","1fr","2fr"],row:["2fr","2fr","2fr","2fr"]},panels:[{row:[1,1],col:[1,1],name:"國片總上映數",class:["highlight","color","color-film"]},{row:[1,1],col:[2,1],name:"國片票房總金額",class:["highlight","color","color-revenue"]},{row:[1,1],col:[3,1],name:"國片總售票數",class:["highlight","color","color-ticket"]},{row:[1,1],col:[4,2],name:"國片當週銷售走勢"},{row:[2,1],col:[5,2],name:"國片與外片逐週銷售比例"},{row:[3,2],col:[5,2],name:"出品人比例"},{row:[2,3],col:[3,2],name:"國片銷售排行與票房佔比"},{row:[2,1],col:[1,2],name:"國片累計銷售金額分布"},{row:[3,1],col:[1,2],name:"國片累計銷售票數分布"},{row:[4,1],col:[1,2],name:"國片上映院數分布"}]};this.layout["movie-tw"].panels.map(function(e,t){return e.idx=t,e.layout="movie-tw",e});this.chart["movie-tw"]["電影銷售總排行與票房佔比"]=function(){var e,t;e={raw:this.movie.all,binding:{name:{key:"中文片名"},value:{key:"累計銷售金額"}}};t={line:"#fff",collapse:{enabled:true,method:"count",threshold:15}};return{bind:e,cfg:t,type:"percent-list",dash:"movie-tw"}};this.chart["movie-tw"]["國片銷售排行與票房佔比"]=function(){var e,t;e={raw:this.movie.tw,binding:{name:{key:"中文片名"},value:{key:"累計銷售金額"}}};t={line:"#fff",collapse:{enabled:true,method:"count",threshold:15}};return{bind:e,cfg:t,type:"percent-list",dash:"movie-tw"}};this.chart["movie-tw"]["出品人比例"]=function(e,t){var n,a,r,i,o;t==null&&(t={});n={};this.movie.tw.map(function(e){return(e["出品"]||[]).map(function(e){return n[e]=(n[e]||0)+1})});a={raw:function(){var e,t=[];for(r in e=n){i=e[r];t.push({"出品人":r,"數量":i})}return t}(),binding:{name:{key:"出品人"},size:{key:"數量",unit:"部"}}};o={};return{bind:a,cfg:o,type:"bar-list",dash:"movie-tw"}};this.chart["movie-tw"]["申請人比例"]=function(){var n,e,a,r,t;n={};this.movie.all.map(function(e){var t;t=e["申請人"];if(t){return n[t]=(n[t]||0)+1}});e={raw:function(){var e,t=[];for(a in e=n){r=e[a];t.push({name:a,value:r})}return t}(),binding:{name:{key:"name"},value:{key:"value"}}};t={collapse:{enabled:true,method:"count",threshold:6}};return{bind:e,cfg:t,type:"pie",dash:"movie-tw"}};this.chart["movie-tw"]["電影來源國家"]=function(){var e,n,a,t;e={raw:function(){var e,t=[];for(n in e=this.movie.byCountry){a=e[n];t.push({name:n,value:a.length})}return t}.call(this),binding:{value:{key:"value"},name:{key:"name"}}};t={collapse:{enabled:true,threshold:5,method:"count"}};return{cfg:t,bind:e,type:"pie",dash:"movie-tw"}};this.chart["movie-tw"]["國片銷售佔比樹狀圖"]=function(){var e,t;e={};t={raw:this.movie.tw,binding:{name:{key:"中文片名"},area:{key:"累計銷售金額",name:"票房"}}};return{bind:t,cfg:e,type:"treemap",dash:"movie-tw"}};this.chart["movie-tw"]["國片總上映數"]=function(){var e;e={raw:[{value:this.movie.tw.length,number:"國片總上映數"}],binding:{value:{key:"value",unit:"部"},name:{key:"name"}}};return{bind:e,cfg:{},type:"number",dash:"movie-tw"}};this.chart["movie-tw"]["國片票房總金額"]=function(){var e;e={raw:[{value:Math.round(this.total.tw.revenue/1e6),number:"累計銷售金額"}],binding:{value:{key:"value",unit:"百萬新臺幣"},name:{key:"name"}}};return{bind:e,cfg:{},type:"number",dash:"movie-tw"}};this.chart["movie-tw"]["國片總售票數"]=function(){var e;e={raw:[{value:Math.round(this.total.tw.ticket/1e6),number:"總銷售票數"}],binding:{value:{key:"value",unit:"百萬張"},name:{key:"name"}}};return{bind:e,cfg:{},type:"number",dash:"movie-tw"}};this.chart["movie-tw"]["國片累計銷售金額分布"]=function(n,e){var t,a,r,i;e==null&&(e={});t=n.all.binned.tw.revenue.map(function(t){var e;e=n.part.binned.tw.revenue.filter(function(e){return e.x0>=t.x0&&e.x0<t.x1})[0]||[];return{excluded:t.length-e.length,picked:e.length,name:t.x1+""}});a={raw:t,binding:{size:[{key:"picked",name:"銷售金額"},{key:"excluded",name:"銷售金額"}],name:{key:"name",filter:e.name}}};r=pal.colors[0];i={tickFormat:".0~s",tickCount:3,dancing:false,legend:{enabled:false},xaxis:{showCaption:false},pal:{colors:[ldcolor.darker(r,5),r]}};return{bind:a,cfg:i,type:"bar",dash:"movie-tw"}};this.chart["movie-tw"]["國片累計銷售票數分布"]=function(n){var e,t,a,r;e=n.all.binned.tw.ticket.map(function(t){var e;e=n.part.binned.tw.ticket.filter(function(e){return e.x0>=t.x0&&e.x0<t.x1})[0]||[];return{excluded:t.length-e.length,picked:e.length,name:t.x1+"",start:t.x1,end:t.x2}});t={raw:e,binding:{size:[{key:"picked",name:"銷售票數"},{key:"excluded",name:"銷售票數"}],name:{key:"name"}}};a=pal.colors[1];r={tickFormat:".0~s",toggleLegend:false,tickCount:3,dancing:false,legend:{enabled:false},xaxis:{showCaption:false},pal:{colors:[ldcolor.darker(a,5),a]}};return{bind:t,cfg:r,type:"bar",dash:"movie-tw"}};this.chart["movie-tw"]["國片上映院數分布"]=function(n){var e,t,a,r;e=n.all.binned.tw.theatre.map(function(t){var e;e=n.part.binned.tw.theatre.filter(function(e){return e.x0>=t.x0&&e.x0<t.x1})[0]||[];return{excluded:t.length-e.length,picked:e.length,name:t.x1+""}});t={raw:e,binding:{size:[{key:"picked",name:"上映院數"},{key:"excluded",name:"上映院數"}],name:{key:"name"}}};a=pal.colors[2];r={tickCount:3,dancing:false,legend:{enabled:false},xaxis:{showCaption:false},pal:{colors:[ldcolor.darker(a,5),a]}};return{bind:t,cfg:r,type:"bar",dash:"movie-tw"}};this.chart["movie-tw"]["國片當週銷售走勢"]=function(){var e,t,n,a,r,i,o;t=[];for(n in a=this.date.revenue){r=a[n];t.push(r)}e=t;e.sort(function(e,t){if(e.date>t.date){return 1}else if(e.date<t.date){return-1}else{return 0}});e.map(function(e){var t;t=e.date.split("/");return e.dateText=t[0]+"\n"+t[1]+"/"+t[2]});i={raw:e,binding:{value:[{key:"tw",name:"票房",unit:"元"}],order:{key:"dateText",name:"日期"}}};o={dotSize:1.5,legend:{enabled:false},xaxis:{enabled:true,showCaption:false},yaxis:{enabled:true,boundaryTickOffset:false,format:d3.format(".2s")}};return{bind:i,cfg:o,type:"line",dash:"movie-tw"}};return this.chart["movie-tw"]["國片與外片逐週銷售比例"]=function(){var e,t,n,a,r,i,o;t=[];for(n in a=this.date.revenue){r=a[n];t.push(r)}e=t;e.sort(function(e,t){if(e.date>t.date){return 1}else if(e.date<t.date){return-1}else{return 0}});e.map(function(e,t){var n;e.idx=t;n=e.date.split("/");return e.dateText=n[0]+"\n"+n[1]+"/"+n[2]});i={raw:e,binding:{size:[{key:"tw",name:"國內"},{key:"other",name:"國外"}],name:{key:"dateText",name:"日期"}}};o={percent:true,xaxis:{enabled:true,showCaption:false},yaxis:{enabled:false},brush:{enabled:false},pal:{colors:[pal.colors[0],ldcolor.web(ldcolor.complement(pal.colors[0]))]}};return{bind:i,cfg:o,type:"bar",dash:"movie-tw"}}});(function(e){return e.apply(dashboard)})(function(){this.layout["movie-all"]={grid:{col:["1fr","1fr","1fr","2fr","1fr","2fr"],row:["2fr","1fr","1fr","1fr","1fr","1fr","1fr"]},panels:[{row:[1,1],col:[1,1],name:"電影總上映數",class:["highlight","color","color-film"]},{row:[1,1],col:[2,1],name:"電影票房總金額",class:["highlight","color","color-revenue"]},{row:[1,1],col:[3,1],name:"電影總售票數",class:["highlight","color","color-ticket"]},{row:[1,1],col:[4,2],name:"電影當週銷售走勢"},{row:[2,2],col:[1,2],name:"電影累計銷售金額分布"},{row:[4,2],col:[1,2],name:"電影累計銷售票數分布"},{row:[6,2],col:[1,2],name:"電影上映院數分布"},{row:[2,6],col:[3,2],name:"上映電影之來源國家比較"},{row:[2,3],col:[5,2],name:"上映之各國電影數量"},{row:[5,3],col:[5,2],name:"各國銷售金額合計"}]};this.layout["movie-all"].panels.map(function(e,a){return e.idx=a,e.layout="movie-all",e});this.chart["movie-all"]["電影總上映數"]=function(){var e;e={raw:[{value:this.movie.all.length,number:"電影總上映數"}],binding:{value:{key:"value",unit:"部"},name:{key:"name"}}};return{bind:e,cfg:{},type:"number",dash:"all"}};this.chart["movie-all"]["電影票房總金額"]=function(){var e;e={raw:[{value:Math.round(this.total.all.revenue/1e6),number:"累計銷售金額"}],binding:{value:{key:"value",unit:"百萬新臺幣"},name:{key:"name"}}};return{bind:e,cfg:{},type:"number",dash:"all"}};this.chart["movie-all"]["電影總售票數"]=function(){var e;e={raw:[{value:Math.round(this.total.all.ticket/1e6),number:"總銷售票數"}],binding:{value:{key:"value",unit:"百萬張"},name:{key:"name"}}};return{bind:e,cfg:{},type:"number",dash:"all"}};this.chart["movie-all"]["電影當週銷售走勢"]=function(){var e,a,n,l,r,t,i;a=[];for(n in l=this.date.revenue){r=l[n];a.push(r)}e=a;e.sort(function(e,a){if(e.date>a.date){return 1}else if(e.date<a.date){return-1}else{return 0}});e.map(function(e){var a;a=e.date.split("/");return e.dateText=a[0]+"\n"+a[1]+"/"+a[2]});t={raw:e,binding:{value:[{key:"all",name:"票房",unit:"元"}],order:{key:"dateText",name:"日期"}}};i={dotSize:1.5,legend:{enabled:false},xaxis:{enabled:true,showCaption:false},yaxis:{enabled:true,boundaryTickOffset:false,format:d3.format(".2s")}};return{bind:t,cfg:i,type:"line",dash:"all"}};this.chart["movie-all"]["電影累計銷售金額分布"]=function(n){var e,a,l,r;e=n.all.binned.all.revenue.map(function(a){var e;e=n.part.binned.all.revenue.filter(function(e){return e.x0>=a.x0&&e.x0<a.x1})[0]||[];return{excluded:a.length-e.length,picked:e.length,name:a.x1+""}});a={raw:e,binding:{size:[{key:"picked",name:"銷售金額"},{key:"excluded",name:"銷售金額"}],name:{key:"name"}}};l=pal.colors[0];r={tickFormat:".0~s",tickCount:3,dancing:false,legend:{enabled:false},xaxis:{showCaption:false},pal:{colors:[ldcolor.darker(l,5),l]}};return{bind:a,cfg:r,type:"bar",dash:"all"}};this.chart["movie-all"]["電影累計銷售票數分布"]=function(n){var e,a,l,r;e=n.all.binned.all.ticket.map(function(a){var e;e=n.part.binned.all.ticket.filter(function(e){return e.x0>=a.x0&&e.x0<a.x1})[0]||[];return{excluded:a.length-e.length,picked:e.length,name:a.x1+""}});a={raw:e,binding:{size:[{key:"picked",name:"銷售票數"},{key:"excluded",name:"銷售票數"}],name:{key:"name"}}};l=pal.colors[1];r={tickFormat:".0~s",toggleLegend:false,tickCount:3,dancing:false,legend:{enabled:false},xaxis:{showCaption:false},pal:{colors:[ldcolor.darker(l,5),l]}};return{bind:a,cfg:r,type:"bar",dash:"all"}};this.chart["movie-all"]["電影上映院數分布"]=function(n){var e,a,l,r;e=n.all.binned.all.theatre.map(function(a){var e;e=n.part.binned.all.theatre.filter(function(e){return e.x0>=a.x0&&e.x0<a.x1})[0]||[];return{excluded:a.length-e.length,picked:e.length,name:a.x1+""}});a={raw:e,binding:{size:[{key:"picked",name:"上映院數"},{key:"excluded",name:"上映院數"}],name:{key:"name"}}};l=pal.colors[2];r={tickCount:3,dancing:false,legend:{enabled:false},xaxis:{showCaption:false},pal:{colors:[ldcolor.darker(l,5),l]}};return{bind:a,cfg:r,type:"bar",dash:"all"}};this.chart["movie-all"]["上映之各國電影數量"]=function(e){var a,n,l,r;a={raw:function(){var e,a=[];for(n in e=this.movie.byCountry){l=e[n];a.push({name:n,value:l.length})}return a}.call(this),binding:{color:{key:"value",unit:"部"},name:{key:"name"}}};r={pal:{colors:["#444","#e8c05c","#6ee97d","#577aeb"]},legendFormat:".0~s",dimEmpty:true};return{bind:a,cfg:r,type:"worldmap",dash:"all"}};this.chart["movie-all"]["上映電影之來源國家比較"]=function(e){var a,n,l,r;a={raw:function(){var e,a=[];for(n in e=this.movie.byCountry){l=e[n];a.push({name:n,value:l.length})}return a}.call(this),binding:{name:{key:"name"},area:[{key:"value",unit:"部"}],color:{key:"name"}}};r={};return{bind:a,cfg:r,type:"bubble",dash:"all"}};return this.chart["movie-all"]["各國銷售金額合計"]=function(e){var a,l,r,n;a={raw:function(){var e,a=[];for(l in e=this.movie.byCountry){r=e[l];a.push({name:l,value:r.reduce(n,0),category:this.movie.continentmap[l]})}return a;function n(e,a){return e+a["累計銷售金額"]/1e6}}.call(this),binding:{name:{key:"name"},area:{key:"value",unit:"百萬新臺幣"},category:{key:"category"}}};n={legend:{enabled:true,selectable:false}};return{bind:a,cfg:n,type:"treemap",dash:"all"}}});</script></body></html>